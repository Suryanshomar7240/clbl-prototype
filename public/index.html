<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SpeakX CLBL - Home Upgradation System</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #FF6B35 0%, #F7931E 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .phone-frame {
      width: 390px;
      height: 844px;
      background: #000;
      border-radius: 40px;
      padding: 12px;
      box-shadow: 0 25px 80px rgba(0, 0, 0, 0.4);
    }

    .screen {
      width: 100%;
      height: 100%;
      background: #f5f5f5;
      border-radius: 30px;
      overflow: hidden;
      position: relative;
    }

    /* Status Bar & Header */
    .status-bar {
      height: 44px;
      background: linear-gradient(135deg, #FF6B35 0%, #F7931E 100%);
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 20px;
      color: white;
      font-size: 14px;
      font-weight: 500;
      z-index: 200;
    }

    .header {
      background: white;
      padding: 12px 15px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
      z-index: 200;
    }

    .user-info {
      display: flex;
      align-items: center;
      gap: 10px;
      flex: 1;
    }

    .avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: linear-gradient(135deg, #FF6B35 0%, #F7931E 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 22px;
    }

    .user-details {
      flex: 1;
    }

    .user-name {
      font-size: 15px;
      font-weight: bold;
      color: #333;
    }

    .user-location {
      font-size: 11px;
      color: #666;
    }

    .header-actions {
      display: flex;
      gap: 6px;
      align-items: center;
      flex-wrap: wrap;
    }

    /* Header Badges */
    .repair-stars-badge {
      background: linear-gradient(135deg, #9C27B0 0%, #E91E63 100%);
      padding: 6px 12px;
      border-radius: 20px;
      display: flex;
      align-items: center;
      gap: 5px;
      font-weight: bold;
      color: white;
      font-size: 13px;
      box-shadow: 0 3px 10px rgba(156, 39, 176, 0.3);
    }

    .coins-badge {
      background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
      padding: 6px 14px;
      border-radius: 20px;
      display: flex;
      align-items: center;
      gap: 5px;
      font-weight: bold;
      color: white;
      font-size: 13px;
      box-shadow: 0 3px 10px rgba(255, 165, 0, 0.3);
    }

    /* Map */
    .content {
      position: absolute;
      top: 154px;
      left: 0;
      right: 0;
      bottom: 0;
      overflow: scroll;
    }

    .content::-webkit-scrollbar {
      width: 0;
      height: 0;
    }

    .city-map {
      width: 200%;
      height: 200%;
      background: #E8F5E9;
      position: relative;
      padding: 20px;
    }

    .map-background {
      position: absolute;
      inset: 0;
      background:
        repeating-linear-gradient(0deg, rgba(76, 175, 80, 0.03) 0, rgba(76, 175, 80, 0.03) 1px, transparent 1px, transparent 50px),
        repeating-linear-gradient(90deg, rgba(76, 175, 80, 0.03) 0, rgba(76, 175, 80, 0.03) 1px, transparent 1px, transparent 50px),
        linear-gradient(135deg, #E8F5E9 0%, #C8E6C9 100%);
    }

    .map-road {
      position: absolute;
      background: rgba(255, 255, 255, 0.6);
      border: 2px dashed rgba(255, 152, 0, 0.3);
      z-index: 1;
    }

    .road-horizontal {
      height: 30px;
      width: 100%;
      top: 50%;
      left: 0;
    }

    .road-vertical {
      width: 30px;
      height: 100%;
      top: 0;
      left: 50%;
    }

    .map-tree {
      position: absolute;
      font-size: 35px;
      opacity: 0.2;
      z-index: 1;
      pointer-events: none;
    }

    /* Home Building */
    .home-building {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 90px;
      height: 90px;
      background: white;
      border-radius: 15px;
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 10;
      border: 3px solid #4CAF50;
      cursor: pointer;
      transition: all 0.3s;
      position: relative;
    }

    .home-building:active {
      transform: translate(-50%, -50%) scale(0.95);
    }

    .home-building.damaged-1 {
      border-color: #FFA726;
      background: linear-gradient(135deg, white 0%, #FFF3E0 100%);
    }

    .home-building.damaged-2 {
      border-color: #FF5722;
      background: linear-gradient(135deg, white 0%, #FFE0B2 100%);
    }

    .home-building.damaged-3 {
      border-color: #F44336;
      background: linear-gradient(135deg, white 0%, #FFCDD2 100%);
      animation: shake 0.5s infinite;
    }

    @keyframes shake {

      0%,
      100% {
        transform: translate(-50%, -50%) rotate(0deg);
      }

      25% {
        transform: translate(-50%, -50%) rotate(-1deg);
      }

      75% {
        transform: translate(-50%, -50%) rotate(1deg);
      }
    }

    .home-icon {
      font-size: 38px;
      margin-bottom: 4px;
    }

    .home-label {
      font-size: 9px;
      font-weight: bold;
      color: #4CAF50;
      text-align: center;
      line-height: 1.2;
    }

    .home-building.damaged-1 .home-label {
      color: #FFA726;
    }

    .home-building.damaged-2 .home-label {
      color: #FF5722;
    }

    .home-building.damaged-3 .home-label {
      color: #F44336;
    }

    .damage-indicator {
      position: absolute;
      top: -8px;
      right: -8px;
      width: 24px;
      height: 24px;
      background: #F44336;
      border-radius: 50%;
      display: none;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      border: 2px solid white;
      animation: pulse 1s infinite;
    }

    .home-building.damaged-1 .damage-indicator,
    .home-building.damaged-2 .damage-indicator,
    .home-building.damaged-3 .damage-indicator {
      display: flex;
    }

    @keyframes pulse {

      0%,
      100% {
        transform: scale(1);
      }

      50% {
        transform: scale(1.1);
      }
    }

    /* Rent Due Badge */
    .rent-due-badge {
      position: fixed;
      top: 120px;
      left: 25px;
      background: white;
      padding: 8px 12px;
      border-radius: 18px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      z-index: 100;
      border: 2px solid #FF6B35;
    }

    .rent-due-badge.overdue {
      border-color: #F44336;
      background: linear-gradient(135deg, white 0%, #FFEBEE 100%);
      animation: alertPulse 2s infinite;
    }

    @keyframes alertPulse {

      0%,
      100% {
        box-shadow: 0 4px 12px rgba(244, 67, 54, 0.3);
      }

      50% {
        box-shadow: 0 4px 20px rgba(244, 67, 54, 0.6);
      }
    }

    .rent-text {
      font-size: 10px;
      color: #666;
      margin-bottom: 3px;
    }

    .rent-value {
      font-size: 18px;
      font-weight: bold;
      color: #FF6B35;
    }

    .rent-due-badge.overdue .rent-value {
      color: #F44336;
    }

    /* Quest Pins */
    .quest-pin {
      position: absolute;
      width: 50px;
      height: 50px;
      cursor: pointer;
      transition: transform 0.3s;
      z-index: 5;
    }

    .quest-pin:hover {
      transform: scale(1.15);
    }

    .pin-icon {
      width: 50px;
      height: 50px;
      background: linear-gradient(135deg, #FF6B35, #F7931E);
      border-radius: 50% 50% 50% 0;
      transform: rotate(-45deg);
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 15px rgba(255, 107, 53, 0.4);
    }

    .pin-emoji {
      font-size: 22px;
      transform: rotate(45deg);
    }

    .pin-label {
      position: absolute;
      bottom: -24px;
      left: 50%;
      transform: translateX(-50%);
      background: white;
      padding: 3px 8px;
      border-radius: 10px;
      font-size: 10px;
      font-weight: bold;
      white-space: nowrap;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      border: 1.5px solid #FF6B35;
    }

    /* Modal Overlay */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.7);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 300;
      padding: 20px;
    }

    .modal-overlay.active {
      display: flex;
    }

    /* Home Details Modal */
    .home-modal-content {
      background: white;
      border-radius: 25px;
      width: 100%;
      max-width: 350px;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    }

    .home-modal-header {
      background: linear-gradient(135deg, #FF6B35 0%, #F7931E 100%);
      padding: 20px;
      border-radius: 25px 25px 0 0;
      text-align: center;
      color: white;
    }

    .home-modal-icon {
      font-size: 50px;
      margin-bottom: 10px;
    }

    .home-modal-title {
      font-size: 22px;
      font-weight: bold;
      margin-bottom: 5px;
    }

    .home-modal-subtitle {
      font-size: 13px;
      opacity: 0.9;
    }

    .home-modal-body {
      padding: 20px;
    }

    .damage-status {
      background: linear-gradient(135deg, #FFEBEE 0%, #FFCDD2 100%);
      padding: 15px;
      border-radius: 15px;
      margin-bottom: 15px;
      border: 2px solid #F44336;
    }

    .damage-status.healthy {
      background: linear-gradient(135deg, #E8F5E9 0%, #C8E6C9 100%);
      border-color: #4CAF50;
    }

    .damage-title {
      font-size: 14px;
      font-weight: bold;
      color: #F44336;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .damage-status.healthy .damage-title {
      color: #4CAF50;
    }

    .damage-description {
      font-size: 12px;
      color: #666;
    }

    .home-stats {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-bottom: 15px;
    }

    .stat-card {
      background: #f5f5f5;
      padding: 12px;
      border-radius: 12px;
      text-align: center;
    }

    .stat-label {
      font-size: 11px;
      color: #666;
      margin-bottom: 5px;
    }

    .stat-value {
      font-size: 18px;
      font-weight: bold;
      color: #FF6B35;
    }

    .home-features {
      margin-bottom: 15px;
    }

    .features-title {
      font-size: 14px;
      font-weight: bold;
      color: #333;
      margin-bottom: 10px;
    }

    .feature-item {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 8px 0;
      font-size: 13px;
      color: #666;
    }

    .modal-actions {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }

    .modal-button {
      flex: 1;
      padding: 14px;
      border: none;
      border-radius: 12px;
      font-size: 15px;
      font-weight: bold;
      cursor: pointer;
      transition: transform 0.2s;
    }

    .modal-button:active {
      transform: scale(0.97);
    }

    .upgrade-button {
      background: linear-gradient(135deg, #4CAF50 0%, #8BC34A 100%);
      color: white;
    }

    .upgrade-button:disabled {
      background: #ccc;
      cursor: not-allowed;
    }

    .repair-button {
      background: linear-gradient(135deg, #9C27B0 0%, #E91E63 100%);
      color: white;
    }

    .close-button {
      background: #f5f5f5;
      color: #666;
    }

    /* Upgrade Modal - Carousel Style */
    .upgrade-modal-content {
      background: white;
      border-radius: 25px;
      width: 90%;
      max-width: 360px;
      max-height: 90vh;
      overflow: hidden;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      display: flex;
      flex-direction: column;
    }

    .upgrade-header {
      background: linear-gradient(135deg, #4CAF50 0%, #8BC34A 100%);
      padding: 18px 20px;
      text-align: center;
      color: white;
      flex-shrink: 0;
    }

    .upgrade-header-title {
      font-size: 20px;
      font-weight: bold;
      margin-bottom: 5px;
    }

    .upgrade-header-subtitle {
      font-size: 12px;
      opacity: 0.9;
    }

    /* Navigation Dots */
    .carousel-nav {
      display: flex;
      gap: 8px;
      padding: 15px 20px;
      overflow-x: auto;
      scroll-behavior: smooth;
      background: #f9f9f9;
      border-bottom: 1px solid #eee;
    }

    .carousel-nav::-webkit-scrollbar {
      height: 4px;
    }

    .carousel-nav::-webkit-scrollbar-track {
      background: #f0f0f0;
    }

    .carousel-nav::-webkit-scrollbar-thumb {
      background: #ccc;
      border-radius: 4px;
    }

    .carousel-dot {
      min-width: 52px;
      height: 52px;
      border-radius: 50%;
      border: 3px solid #ddd;
      background: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      cursor: pointer;
      transition: all 0.3s;
      flex-shrink: 0;
      position: relative;
    }

    .carousel-dot.active {
      border-color: #4CAF50;
      background: linear-gradient(135deg, #E8F5E9 0%, #C8E6C9 100%);
      transform: scale(1.15);
      box-shadow: 0 4px 12px rgba(76, 175, 80, 0.4);
    }

    .carousel-dot.current {
      border-color: #FF6B35;
      background: linear-gradient(135deg, #FFF4E6 0%, #FFE9CC 100%);
    }

    .carousel-dot.locked {
      opacity: 0.3;
      cursor: not-allowed;
    }

    /* Carousel Container */
    .carousel-container {
      position: relative;
      flex: 1;
      overflow: hidden;
    }

    .carousel-wrapper {
      display: flex;
      transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      height: 100%;
    }

    .carousel-slide {
      min-width: 100%;
      padding: 20px;
      overflow-y: auto;
    }

    .carousel-slide::-webkit-scrollbar {
      width: 4px;
    }

    .carousel-slide::-webkit-scrollbar-track {
      background: #f0f0f0;
    }

    .carousel-slide::-webkit-scrollbar-thumb {
      background: #ccc;
      border-radius: 4px;
    }

    /* Home Card */
    .home-card-header {
      text-align: center;
      margin-bottom: 18px;
    }

    .home-card-icon {
      font-size: 65px;
      margin-bottom: 12px;
    }

    .home-card-title {
      font-size: 24px;
      font-weight: bold;
      color: #333;
      margin-bottom: 6px;
    }

    .home-card-subtitle {
      font-size: 13px;
      color: #666;
      line-height: 1.4;
    }

    .home-card-badge {
      display: inline-block;
      padding: 5px 14px;
      border-radius: 14px;
      font-size: 11px;
      font-weight: bold;
      margin-top: 10px;
    }

    .badge-current {
      background: linear-gradient(135deg, #FF6B35 0%, #F7931E 100%);
      color: white;
    }

    .badge-locked {
      background: #f5f5f5;
      color: #999;
    }

    .badge-available {
      background: linear-gradient(135deg, #4CAF50 0%, #8BC34A 100%);
      color: white;
    }

    /* Cost Grid */
    .cost-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-bottom: 18px;
    }

    .cost-card {
      background: #f5f5f5;
      padding: 14px;
      border-radius: 14px;
      text-align: center;
    }

    .cost-card.highlight {
      background: linear-gradient(135deg, #FFF4E6 0%, #FFE9CC 100%);
      border: 2px solid #FFB74D;
    }

    .cost-card-label {
      font-size: 11px;
      color: #666;
      margin-bottom: 6px;
      font-weight: 600;
    }

    .cost-card-value {
      font-size: 20px;
      font-weight: bold;
      color: #FF6B35;
    }

    /* Features Section - Scrollable */
    .features-section {
      margin-bottom: 15px;
    }

    .features-header {
      font-size: 14px;
      font-weight: bold;
      margin-bottom: 12px;
      color: #333;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .features-scroll {
      max-height: 200px;
      overflow-y: auto;
      padding-right: 5px;
    }

    .features-scroll::-webkit-scrollbar {
      width: 4px;
    }

    .features-scroll::-webkit-scrollbar-track {
      background: #f0f0f0;
      border-radius: 4px;
    }

    .features-scroll::-webkit-scrollbar-thumb {
      background: #4CAF50;
      border-radius: 4px;
    }

    .features-scroll::-webkit-scrollbar-thumb:hover {
      background: #45a049;
    }

    .features-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
    }

    .feature-tag {
      background: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%);
      padding: 10px;
      border-radius: 10px;
      font-size: 11px;
      color: #1976D2;
      display: flex;
      align-items: center;
      gap: 6px;
      font-weight: 600;
      line-height: 1.3;
    }

    /* Carousel Actions */
    .carousel-actions {
      padding: 15px 20px;
      background: #f9f9f9;
      border-top: 1px solid #eee;
      flex-shrink: 0;
    }

    .carousel-button {
      width: 100%;
      padding: 14px;
      border: none;
      border-radius: 12px;
      font-size: 15px;
      font-weight: bold;
      cursor: pointer;
      transition: transform 0.2s;
      margin-bottom: 8px;
    }

    .carousel-button:active:not(:disabled) {
      transform: scale(0.97);
    }

    .carousel-button.upgrade {
      background: linear-gradient(135deg, #4CAF50 0%, #8BC34A 100%);
      color: white;
    }

    .carousel-button.upgrade:disabled {
      background: #ccc;
      cursor: not-allowed;
      opacity: 0.6;
    }

    .carousel-button.close {
      background: white;
      color: #666;
      border: 1px solid #ddd;
    }

    /* Rent Payment Modal */
    .rent-modal-content {
      background: white;
      border-radius: 25px;
      padding: 30px;
      width: 90%;
      max-width: 340px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      text-align: center;
    }

    .rent-modal-icon {
      font-size: 60px;
      margin-bottom: 15px;
    }

    .rent-modal-title {
      font-size: 24px;
      font-weight: bold;
      color: #333;
      margin-bottom: 10px;
    }

    .rent-modal-message {
      font-size: 14px;
      color: #666;
      margin-bottom: 20px;
      line-height: 1.5;
    }

    .rent-amount-display {
      background: linear-gradient(135deg, #FFF4E6 0%, #FFE9CC 100%);
      padding: 20px;
      border-radius: 15px;
      margin-bottom: 20px;
    }

    .rent-amount-label {
      font-size: 12px;
      color: #666;
      margin-bottom: 5px;
    }

    .rent-amount-value {
      font-size: 32px;
      font-weight: bold;
      color: #FF6B35;
    }

    /* Toast Notification */
    .toast {
      position: fixed;
      top: 120px;
      left: 50%;
      transform: translateX(-50%) translateY(-150%);
      background: white;
      padding: 16px 22px;
      border-radius: 18px;
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.25);
      z-index: 500;
      transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      border: 2px solid #4CAF50;
      text-align: center;
      max-width: 85%;
    }

    .toast.active {
      transform: translateX(-50%) translateY(0);
    }

    .toast.error {
      border-color: #F44336;
    }

    .toast-title {
      font-size: 15px;
      font-weight: bold;
      color: #4CAF50;
      margin-bottom: 4px;
    }

    .toast.error .toast-title {
      color: #F44336;
    }

    .toast-message {
      font-size: 12px;
      color: #666;
    }

    /* Confetti */
    .confetti {
      position: fixed;
      width: 10px;
      height: 10px;
      border-radius: 50%;
      animation: fall 3s linear;
      z-index: 600;
    }

    @keyframes fall {
      to {
        transform: translateY(100vh) rotate(720deg);
        opacity: 0;
      }
    }

    /* Tab Navigation */
    .tab-bar {
      display: flex;
      background: white;
      border-bottom: 1px solid #eee;
      z-index: 200;
      position: relative;
    }

    .tab-button {
      flex: 1;
      padding: 12px;
      border: none;
      background: transparent;
      font-size: 13px;
      font-weight: 600;
      color: #888;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      position: relative;
    }

    .tab-button.active {
      color: #FF6B35;
      background: linear-gradient(180deg, rgba(255, 107, 53, 0.08) 0%, transparent 100%);
    }

    .tab-button.active::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 10%;
      right: 10%;
      height: 3px;
      background: linear-gradient(135deg, #FF6B35 0%, #F7931E 100%);
      border-radius: 3px 3px 0 0;
    }

    .tab-content {
      display: none;
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
    }

    .tab-content.active {
      display: block;
    }

    /* My Property Map */
    .property-map {
      width: 200%;
      height: 200%;
      background: linear-gradient(180deg, #87CEEB 0%, #87CEEB 15%, #90EE90 15%, #228B22 100%);
      position: relative;
      padding: 20px;
    }

    .property-grass {
      position: absolute;
      inset: 0;
      top: 15%;
      background:
        repeating-linear-gradient(90deg, rgba(34, 139, 34, 0.1) 0, rgba(34, 139, 34, 0.1) 2px, transparent 2px, transparent 40px),
        repeating-linear-gradient(0deg, rgba(34, 139, 34, 0.1) 0, rgba(34, 139, 34, 0.1) 2px, transparent 2px, transparent 40px),
        linear-gradient(135deg, #90EE90 0%, #32CD32 50%, #228B22 100%);
    }

    .property-cloud {
      position: absolute;
      font-size: 40px;
      opacity: 0.8;
      animation: floatCloud 20s ease-in-out infinite;
    }

    @keyframes floatCloud {

      0%,
      100% {
        transform: translateX(0);
      }

      50% {
        transform: translateX(20px);
      }
    }

    .property-tree {
      position: absolute;
      font-size: 50px;
      filter: drop-shadow(2px 4px 6px rgba(0, 0, 0, 0.2));
      z-index: 2;
    }

    .property-bush {
      position: absolute;
      font-size: 30px;
      z-index: 1;
    }

    .stone-path {
      position: absolute;
      top: 55%;
      left: 30%;
      width: 40%;
      height: 60px;
      background: repeating-linear-gradient(90deg, #A9A9A9 0, #A9A9A9 30px, #808080 30px, #808080 32px);
      border-radius: 10px;
      opacity: 0.7;
      z-index: 1;
    }

    /* Property House */
    .property-house {
      position: absolute;
      top: 45%;
      left: 50%;
      transform: translate(-50%, -50%);
      display: flex;
      align-items: flex-end;
      gap: 15px;
      z-index: 10;
    }

    .property-house-building {
      width: 120px;
      height: 120px;
      background: white;
      border-radius: 20px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.25);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      border: 4px solid #4CAF50;
      cursor: pointer;
      transition: all 0.3s;
      position: relative;
    }

    .property-house-building:active {
      transform: scale(0.95);
    }

    .property-house-building.broken {
      border-color: #F44336;
      background: linear-gradient(135deg, #fff 0%, #FFCDD2 100%);
      animation: houseShake 0.5s infinite;
    }

    @keyframes houseShake {

      0%,
      100% {
        transform: rotate(0deg);
      }

      25% {
        transform: rotate(-2deg);
      }

      75% {
        transform: rotate(2deg);
      }
    }

    .property-house-icon {
      font-size: 55px;
      margin-bottom: 5px;
    }

    .property-house-label {
      font-size: 11px;
      font-weight: bold;
      color: #4CAF50;
    }

    .property-house-building.broken .property-house-label {
      color: #F44336;
    }

    .property-car {
      font-size: 45px;
      filter: drop-shadow(2px 4px 6px rgba(0, 0, 0, 0.2));
    }

    .damage-crack-overlay {
      position: absolute;
      inset: 0;
      background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Cpath d='M20 0 L25 30 L15 50 L30 70 L20 100' stroke='%23333' stroke-width='2' fill='none' opacity='0.3'/%3E%3Cpath d='M60 0 L55 25 L70 45 L50 75 L65 100' stroke='%23333' stroke-width='2' fill='none' opacity='0.3'/%3E%3C/svg%3E");
      pointer-events: none;
      display: none;
    }

    .property-house-building.broken .damage-crack-overlay {
      display: block;
    }

    .property-warning-badge {
      position: absolute;
      top: -12px;
      right: -12px;
      width: 32px;
      height: 32px;
      background: #F44336;
      border-radius: 50%;
      display: none;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      border: 3px solid white;
      animation: pulse 1s infinite;
    }

    .property-house-building.broken .property-warning-badge {
      display: flex;
    }

    /* Timer Badge */
    .timer-badge {
      position: fixed;
      top: 175px;
      right: 25px;
      background: white;
      padding: 10px 15px;
      border-radius: 20px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
      z-index: 100;
      border: 2px solid #4CAF50;
      text-align: center;
    }

    .timer-badge.warning {
      border-color: #FF9800;
      animation: alertPulse 1s infinite;
    }

    .timer-badge.danger {
      border-color: #F44336;
      background: linear-gradient(135deg, white 0%, #FFEBEE 100%);
    }

    .timer-label {
      font-size: 9px;
      color: #666;
      margin-bottom: 3px;
      font-weight: 600;
    }

    .timer-value {
      font-size: 20px;
      font-weight: bold;
      color: #4CAF50;
      font-family: monospace;
    }

    .timer-badge.warning .timer-value {
      color: #FF9800;
    }

    .timer-badge.danger .timer-value {
      color: #F44336;
    }

    /* Pay Rent Modal */
    .pay-rent-modal-content {
      background: white;
      border-radius: 25px;
      padding: 30px;
      width: 90%;
      max-width: 340px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      text-align: center;
    }

    .pay-rent-icon {
      font-size: 60px;
      margin-bottom: 15px;
    }

    .pay-rent-title {
      font-size: 24px;
      font-weight: bold;
      color: #F44336;
      margin-bottom: 10px;
    }

    .pay-rent-message {
      font-size: 14px;
      color: #666;
      margin-bottom: 20px;
      line-height: 1.5;
    }

    .pay-rent-amount {
      background: linear-gradient(135deg, #FFEBEE 0%, #FFCDD2 100%);
      padding: 20px;
      border-radius: 15px;
      margin-bottom: 20px;
      border: 2px solid #F44336;
    }

    .pay-rent-amount-label {
      font-size: 12px;
      color: #666;
      margin-bottom: 5px;
    }

    .pay-rent-amount-value {
      font-size: 32px;
      font-weight: bold;
      color: #F44336;
    }

    .pay-rent-buttons {
      display: flex;
      gap: 10px;
    }

    .pay-rent-btn {
      flex: 1;
      padding: 14px;
      border: none;
      border-radius: 12px;
      font-size: 14px;
      font-weight: bold;
      cursor: pointer;
    }

    .pay-rent-btn.primary {
      background: linear-gradient(135deg, #4CAF50 0%, #8BC34A 100%);
      color: white;
    }

    .pay-rent-btn.secondary {
      background: #f5f5f5;
      color: #666;
    }

    /* Success Modal */
    .success-modal-content {
      background: white;
      border-radius: 25px;
      padding: 30px;
      width: 90%;
      max-width: 340px;
      text-align: center;
    }

    .success-icon {
      font-size: 70px;
      margin-bottom: 15px;
    }

    .success-title {
      font-size: 26px;
      font-weight: bold;
      color: #4CAF50;
      margin-bottom: 10px;
    }

    .success-message {
      font-size: 14px;
      color: #666;
      margin-bottom: 25px;
    }
  </style>
</head>

<body>
  <div class="phone-frame">
    <div class="screen">
      <!-- Status Bar -->
      <div class="status-bar">
        <div>9:41</div>
        <div>ğŸ“¶ âš¡ 100%</div>
      </div>

      <!-- Header -->
      <div class="header">
        <div class="user-info">
          <div class="avatar">ğŸ‘¨</div>
          <div class="user-details">
            <div class="user-name">Rahul Sharma</div>
            <div class="user-location">ğŸ“ Connaught Place</div>
          </div>
        </div>
        <div class="header-actions">
          <div class="repair-stars-badge">
            <span id="repairStars">3</span> â­
          </div>
          <div class="coins-badge">
            <span id="coinsDisplay">5000</span> ğŸª™
          </div>
        </div>
      </div>

      <!-- Tab Navigation -->
      <div class="tab-bar">
        <button class="tab-button active" onclick="switchTab('cityMap')" id="cityMapTabBtn">
          ğŸ—ºï¸ City Map
        </button>
        <button class="tab-button" onclick="switchTab('myProperty')" id="myPropertyTabBtn">
          ğŸ¡ My Property
        </button>
      </div>

      <!-- City Map Tab Content -->
      <div class="content" id="cityMapContent">
        <div class="tab-content active" id="cityMapTab">
          <div class="city-map">
            <div class="map-background"></div>

            <!-- Roads -->
            <div class="map-road road-horizontal"></div>
            <div class="map-road road-vertical"></div>

            <!-- Trees -->
            <div class="map-tree" style="top: 25%; left: 35%;">ğŸŒ³</div>
            <div class="map-tree" style="top: 60%; left: 70%;">ğŸŒ³</div>
            <div class="map-tree" style="bottom: 30%; left: 25%;">ğŸŒ³</div>
            <div class="map-tree" style="top: 40%; right: 30%;">ğŸŒ³</div>

            <!-- Home Building -->
            <div class="home-building" id="homeBuilding" onclick="showHomeDetails()">
              <div class="damage-indicator">âš ï¸</div>
              <div class="home-icon" id="homeIcon">ğŸ </div>
              <div class="home-label" id="homeLabel">HOSTEL<br>No Rent</div>
            </div>

            <!-- Quest Pins -->
            <div class="quest-pin" style="top: 35%; left: 60%;" onclick="completeQuest('ğŸ½ï¸ Restaurant')">
              <div class="pin-icon">
                <div class="pin-emoji">ğŸ½ï¸</div>
              </div>
              <div class="pin-label">Restaurant</div>
            </div>

            <div class="quest-pin" style="top: 60%; left: 35%;" onclick="completeQuest('ğŸ¦ Bank')">
              <div class="pin-icon">
                <div class="pin-emoji">ğŸ¦</div>
              </div>
              <div class="pin-label">Bank</div>
            </div>

            <div class="quest-pin" style="top: 30%; left: 35%;" onclick="completeQuest('ğŸŒ³ Park')">
              <div class="pin-icon">
                <div class="pin-emoji">ğŸŒ³</div>
              </div>
              <div class="pin-label">Park</div>
            </div>

            <div class="quest-pin" style="top: 55%; left: 60%;" onclick="completeQuest('ğŸ¥ Hospital')">
              <div class="pin-icon">
                <div class="pin-emoji">ğŸ¥</div>
              </div>
              <div class="pin-label">Hospital</div>
            </div>
          </div>
        </div>
      </div>

      <!-- My Property Tab Content -->
      <div class="content" id="myPropertyContent" style="display: none;">
        <div class="tab-content active" id="myPropertyTab">
          <div class="property-map">
            <div class="property-grass"></div>

            <!-- Clouds -->
            <div class="property-cloud" style="top: 3%; left: 10%;">â˜ï¸</div>
            <div class="property-cloud" style="top: 5%; left: 50%; animation-delay: -5s;">â˜ï¸</div>
            <div class="property-cloud" style="top: 2%; left: 80%; animation-delay: -10s;">â˜ï¸</div>

            <!-- Trees -->
            <div class="property-tree" style="top: 25%; left: 15%;">ğŸŒ³</div>
            <div class="property-tree" style="top: 30%; left: 80%;">ğŸŒ³</div>
            <div class="property-tree" style="top: 65%; left: 20%;">ğŸŒ²</div>
            <div class="property-tree" style="top: 70%; left: 75%;">ğŸŒ²</div>
            <div class="property-tree" style="top: 20%; left: 60%;">ğŸŒ´</div>

            <!-- Bushes -->
            <div class="property-bush" style="top: 35%; left: 25%;">ğŸŒ¿</div>
            <div class="property-bush" style="top: 55%; left: 70%;">ğŸŒ¿</div>
            <div class="property-bush" style="top: 40%; left: 85%;">ğŸŒ¿</div>
            <div class="property-bush" style="top: 60%; left: 10%;">ğŸŒ»</div>

            <!-- Stone Path -->
            <div class="stone-path"></div>

            <!-- Property House with Car -->
            <div class="property-house">
              <div class="property-house-building" id="propertyHouseBuilding" onclick="handlePropertyHouseClick()">
                <div class="damage-crack-overlay"></div>
                <div class="property-warning-badge">âš ï¸</div>
                <div class="property-house-icon" id="propertyHouseIcon">ğŸ </div>
                <div class="property-house-label" id="propertyHouseLabel">MY HOME</div>
              </div>
              <div class="property-car">ğŸš—</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Timer Badge (for My Property tab) -->
      <div class="timer-badge" id="timerBadge" style="display: none;">
        <div class="timer-label">NEXT REPAIR IN</div>
        <div class="timer-value" id="timerValue">2:00</div>
      </div>

      <!-- Rent Due Badge -->
      <div class="rent-due-badge" id="rentBadge">
        <div class="rent-text">DAILY RENT</div>
        <div class="rent-value"><span id="rentDisplay">0</span> ğŸª™</div>
      </div>

      <!-- Home Details Modal -->
      <div class="modal-overlay" id="homeModal">
        <div class="home-modal-content">
          <div class="home-modal-header">
            <div class="home-modal-icon" id="modalHomeIcon">ğŸ </div>
            <div class="home-modal-title" id="modalHomeTitle">Hostel</div>
            <div class="home-modal-subtitle" id="modalHomeSubtitle">Your starter home</div>
          </div>
          <div class="home-modal-body">
            <div class="damage-status healthy" id="damageStatus">
              <div class="damage-title">âœ… Perfect Condition</div>
              <div class="damage-description">Your home is well maintained!</div>
            </div>

            <div class="home-stats">
              <div class="stat-card">
                <div class="stat-label">Purchase Cost</div>
                <div class="stat-value" id="modalPurchaseCost">Free</div>
              </div>
              <div class="stat-card">
                <div class="stat-label">Daily Rent</div>
                <div class="stat-value" id="modalDailyRent">0 ğŸª™</div>
              </div>
            </div>

            <div class="home-features">
              <div class="features-title">ğŸ¡ Home Features</div>
              <div id="featuresList"></div>
            </div>

            <div class="modal-actions">
              <button class="modal-button upgrade-button" id="upgradeBtn" onclick="showUpgradeModal()">
                â¬†ï¸ Upgrade Home
              </button>
              <button class="modal-button repair-button" id="repairBtn" onclick="repairHome()" style="display: none;">
                ğŸ”§ Repair (1â­)
              </button>
            </div>
            <button class="modal-button close-button" onclick="closeHomeModal()"
              style="margin-top: 10px;">Close</button>
          </div>
        </div>
      </div>

      <!-- Rent Payment Modal -->
      <div class="modal-overlay" id="rentModal">
        <div class="rent-modal-content">
          <div class="rent-modal-icon">ğŸ‰</div>
          <div class="rent-modal-title">Hurray!</div>
          <div class="rent-modal-message">You've successfully paid your rent. Practice now to earn bonus coins
            and recover your coins!</div>
          <div class="rent-amount-display">
            <div class="rent-amount-label">Rent Paid</div>
            <div class="rent-amount-value"><span id="rentPaidAmount">0</span> ğŸª™</div>
          </div>
          <button class="modal-button upgrade-button" onclick="closeRentModal()">Let's Practice! ğŸš€</button>
        </div>
      </div>

      <!-- Upgrade Modal with Carousel -->
      <div class="modal-overlay" id="upgradeModal">
        <div class="upgrade-modal-content">
          <div class="upgrade-header">
            <div class="upgrade-header-title">ğŸ  Home Upgrades</div>
            <div class="upgrade-header-subtitle">Swipe to explore all homes</div>
          </div>

          <div class="carousel-nav" id="carouselNav"></div>

          <div class="carousel-container">
            <div class="carousel-wrapper" id="carouselWrapper"></div>
          </div>

          <div class="carousel-actions">
            <button class="carousel-button upgrade" id="carouselUpgradeBtn" onclick="upgradeFromCarousel()">
              â¬†ï¸ Upgrade to this Home
            </button>
            <button class="carousel-button close" onclick="closeUpgradeModal()">Close</button>
          </div>
        </div>
      </div>

      <!-- Pay Rent Modal (for broken property house) -->
      <div class="modal-overlay" id="payRentModal">
        <div class="pay-rent-modal-content">
          <div class="pay-rent-icon">ğŸšï¸</div>
          <div class="pay-rent-title">House Needs Repair!</div>
          <div class="pay-rent-message">Your property has deteriorated and needs repairs. Pay the repair cost to fix it!
          </div>
          <div class="pay-rent-amount">
            <div class="pay-rent-amount-label">Repair Cost</div>
            <div class="pay-rent-amount-value">500 ğŸª™</div>
          </div>
          <div class="pay-rent-buttons">
            <button class="pay-rent-btn primary" onclick="payPropertyRent()">ğŸ’° Pay Rent & Repair</button>
            <button class="pay-rent-btn secondary" onclick="closePayRentModal()">Later</button>
          </div>
        </div>
      </div>

      <!-- Success Modal (after repair) -->
      <div class="modal-overlay" id="successModal">
        <div class="success-modal-content">
          <div class="success-icon">ğŸ‰</div>
          <div class="success-title">House Repaired!</div>
          <div class="success-message">Your property is restored to perfect condition. Keep earning coins to maintain
            it!</div>
          <button class="modal-button upgrade-button" onclick="closeSuccessModal()">Continue ğŸ </button>
        </div>
      </div>

      <!-- Toast Notification -->
      <div class="toast" id="toast">
        <div class="toast-title" id="toastTitle">Success!</div>
        <div class="toast-message" id="toastMessage">Action completed</div>
      </div>
    </div>
  </div>

  <script>
    // Home Data
    const HOMES = {
      hostel: {
        name: 'Hostel',
        icon: 'ğŸ ',
        purchaseCost: 0,
        dailyRent: 0,
        subtitle: 'Your starter home',
        features: [
          'ğŸ›ï¸ Shared dormitory',
          'ğŸš¿ Common bathroom',
          'ğŸ½ï¸ Mess facility',
          'ğŸ“š Study area',
          'ğŸ”’ Basic security'
        ],
        description: 'A basic shared living space for students'
      },
      pg: {
        name: 'PG',
        icon: 'ğŸ˜ï¸',
        purchaseCost: 2000,
        dailyRent: 50,
        subtitle: 'Rent starts here',
        features: [
          'ğŸ›ï¸ Private room',
          'ğŸš¿ Shared bathroom',
          'ğŸ½ï¸ 2 meals included',
          'ğŸ“¶ WiFi included',
          'ğŸ§º Laundry service',
          'ğŸ”‘ Room key access'
        ],
        description: 'Your first independent living space'
      },
      studio: {
        name: 'Studio',
        icon: 'ğŸ¢',
        purchaseCost: 6000,
        dailyRent: 120,
        subtitle: 'First independence',
        features: [
          'ğŸ›ï¸ Private bedroom',
          'ğŸš¿ Private bathroom',
          'ğŸ³ Small kitchen',
          'ğŸ“º Living space',
          'ğŸ…¿ï¸ Parking spot',
          'ğŸŒ¡ï¸ AC facility',
          'ğŸ’¡ Power backup'
        ],
        description: 'Complete privacy in a compact space'
      },
      '1bhk': {
        name: '1BHK',
        icon: 'ğŸ¡',
        purchaseCost: 12000,
        dailyRent: 220,
        subtitle: 'Adult life begins',
        features: [
          'ğŸ›ï¸ Spacious bedroom',
          'ğŸš¿ Modern bathroom',
          'ğŸ³ Full kitchen',
          'ğŸ›‹ï¸ Living room',
          'ğŸŒ¿ Balcony',
          'ğŸ”’ Security system',
          'ğŸš— Covered parking',
          'ğŸ’¼ Work desk area'
        ],
        description: 'A proper apartment for independent living'
      },
      '2bhk': {
        name: '2BHK',
        icon: 'ğŸ ',
        purchaseCost: 22000,
        dailyRent: 350,
        subtitle: 'Financial growth',
        features: [
          'ğŸ›ï¸ 2 Bedrooms',
          'ğŸš¿ 2 Bathrooms',
          'ğŸ³ Modular kitchen',
          'ğŸ›‹ï¸ Large living room',
          'ğŸŒ¿ Big balcony',
          'ğŸ® Space for hobbies',
          'ğŸ’¼ Work from home setup',
          'ğŸ“š Study room',
          'ğŸ¨ Storage space'
        ],
        description: 'Room to grow and entertain'
      },
      '3bhk': {
        name: '3BHK',
        icon: 'ğŸ˜ï¸',
        purchaseCost: 40000,
        dailyRent: 550,
        subtitle: 'Aspirational lifestyle',
        features: [
          'ğŸ›ï¸ 3 Bedrooms',
          'ğŸš¿ 3 Bathrooms',
          'ğŸ³ Premium kitchen',
          'ğŸ›‹ï¸ Spacious living area',
          'ğŸŒ¿ Multiple balconies',
          'ğŸ¯ Home office',
          'ğŸ¨ Guest room',
          'ğŸ‹ï¸ Gym access',
          'ğŸ¬ Entertainment room',
          'ğŸ· Mini bar area'
        ],
        description: 'Luxury living with space for everything'
      },
      luxury: {
        name: 'Luxury Apartment',
        icon: 'ğŸ›ï¸',
        purchaseCost: 70000,
        dailyRent: 850,
        subtitle: 'High success',
        features: [
          'ğŸ›ï¸ 3+ Bedrooms',
          'ğŸš¿ Designer bathrooms',
          'ğŸ³ Chef kitchen',
          'ğŸ›‹ï¸ Premium interiors',
          'ğŸŒ¿ Terrace garden',
          'ğŸŠ Pool access',
          'ğŸ¾ Sports facilities',
          'ğŸš— Premium parking',
          'ğŸ” 24/7 security',
          'ğŸ­ Club membership',
          'ğŸ§˜ Yoga studio',
          'ğŸ‘” Concierge service'
        ],
        description: 'Premium living with all amenities'
      },
      villa: {
        name: 'Villa',
        icon: 'ğŸ°',
        purchaseCost: 120000,
        dailyRent: 1400,
        subtitle: 'Dream achievement',
        features: [
          'ğŸ›ï¸ 4+ Bedrooms',
          'ğŸš¿ Luxury bathrooms',
          'ğŸ³ Gourmet kitchen',
          'ğŸ›‹ï¸ Multiple living areas',
          'ğŸŒ³ Private garden',
          'ğŸŠ Private pool',
          'ğŸš— Multiple car garage',
          'ğŸ­ Entertainment room',
          'ğŸ‹ï¸ Private gym',
          'ğŸ‘¨â€ğŸ³ Staff quarters',
          'ğŸ¬ Home theater',
          'ğŸ· Wine cellar',
          'ğŸ¨ Art gallery space'
        ],
        description: 'The pinnacle of success and luxury'
      }
    };

    const HOME_SEQUENCE = ['hostel', 'pg', 'studio', '1bhk', '2bhk', '3bhk', 'luxury', 'villa'];

    let gameState = {
      coins: 5000,
      repairStars: 3,
      currentHome: 'hostel',
      damageLevel: 0,
      daysSinceRent: 0,
      lastLoginDate: null,
      rentPaid: true,
      // Property tab state
      propertyTimerStart: null,
      isPropertyHouseBroken: false,
      currentTab: 'cityMap'
    };

    let currentCarouselIndex = 0;
    let timerInterval = null;
    const PROPERTY_REPAIR_COST = 500;
    const TIMER_DURATION = 120000; // 2 minutes in milliseconds

    // Initialize
    function init() {
      loadGameState();
      checkDailyRent();
      updateUI();
      centerMap();
      // Restore tab state
      if (gameState.currentTab === 'myProperty') {
        switchTab('myProperty');
      }
      // Check if house was broken while away
      checkPropertyTimerOnLoad();
    }

    function loadGameState() {
      const saved = localStorage.getItem('speakx_game_state');
      if (saved) {
        gameState = { ...gameState, ...JSON.parse(saved) };
      }
    }

    function saveGameState() {
      localStorage.setItem('speakx_game_state', JSON.stringify(gameState));
    }

    // ========== TAB SWITCHING ==========
    function switchTab(tabName) {
      gameState.currentTab = tabName;
      saveGameState();

      // Update tab buttons
      document.getElementById('cityMapTabBtn').classList.toggle('active', tabName === 'cityMap');
      document.getElementById('myPropertyTabBtn').classList.toggle('active', tabName === 'myProperty');

      // Update content visibility
      document.getElementById('cityMapContent').style.display = tabName === 'cityMap' ? 'block' : 'none';
      document.getElementById('myPropertyContent').style.display = tabName === 'myProperty' ? 'block' : 'none';

      // Show/hide timer badge and rent badge
      document.getElementById('timerBadge').style.display = tabName === 'myProperty' ? 'block' : 'none';
      document.getElementById('rentBadge').style.display = tabName === 'cityMap' ? 'block' : 'none';

      // Start timer on first visit to My Property
      if (tabName === 'myProperty') {
        if (!gameState.propertyTimerStart && !gameState.isPropertyHouseBroken) {
          gameState.propertyTimerStart = Date.now();
          saveGameState();
        }
        startPropertyTimer();
        centerPropertyMap();
      } else {
        stopPropertyTimer();
        centerMap();
      }
    }

    // ========== PROPERTY TIMER ==========
    function startPropertyTimer() {
      stopPropertyTimer();
      updateTimerDisplay();
      timerInterval = setInterval(updateTimerDisplay, 1000);
    }

    function stopPropertyTimer() {
      if (timerInterval) {
        clearInterval(timerInterval);
        timerInterval = null;
      }
    }

    function updateTimerDisplay() {
      if (gameState.isPropertyHouseBroken) {
        document.getElementById('timerValue').textContent = 'REPAIRS NEEDED!';
        document.getElementById('timerBadge').classList.remove('warning');
        document.getElementById('timerBadge').classList.add('danger');
        document.getElementById('timerBadge').querySelector('.timer-label').textContent = 'âš ï¸ STATUS';
        return;
      }

      if (!gameState.propertyTimerStart) {
        document.getElementById('timerValue').textContent = '2:00';
        return;
      }

      const elapsed = Date.now() - gameState.propertyTimerStart;
      const remaining = Math.max(0, TIMER_DURATION - elapsed);

      if (remaining === 0) {
        triggerHouseBreakdown();
        return;
      }

      const minutes = Math.floor(remaining / 60000);
      const seconds = Math.floor((remaining % 60000) / 1000);
      document.getElementById('timerValue').textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;

      // Update badge styling based on time
      const badge = document.getElementById('timerBadge');
      badge.classList.remove('warning', 'danger');
      badge.querySelector('.timer-label').textContent = 'NEXT REPAIR IN';
      if (remaining < 30000) {
        badge.classList.add('warning');
      }
    }

    function checkPropertyTimerOnLoad() {
      if (gameState.isPropertyHouseBroken) {
        updatePropertyHouseUI();
        return;
      }

      if (gameState.propertyTimerStart) {
        const elapsed = Date.now() - gameState.propertyTimerStart;
        if (elapsed >= TIMER_DURATION) {
          triggerHouseBreakdown();
        }
      }
    }

    function triggerHouseBreakdown() {
      gameState.isPropertyHouseBroken = true;
      gameState.propertyTimerStart = null;
      saveGameState();

      updatePropertyHouseUI();
      showToast('ğŸšï¸ House Broken!', 'Your property needs repairs!', true);

      // Auto-show pay rent modal
      setTimeout(() => showPayRentModal(), 500);
    }

    function updatePropertyHouseUI() {
      const building = document.getElementById('propertyHouseBuilding');
      const icon = document.getElementById('propertyHouseIcon');
      const label = document.getElementById('propertyHouseLabel');

      if (gameState.isPropertyHouseBroken) {
        building.classList.add('broken');
        icon.textContent = 'ğŸšï¸';
        label.textContent = 'NEEDS REPAIR';
      } else {
        building.classList.remove('broken');
        icon.textContent = 'ğŸ ';
        label.textContent = 'MY HOME';
      }

      updateTimerDisplay();
    }

    // ========== PROPERTY HOUSE CLICK ==========
    function handlePropertyHouseClick() {
      if (gameState.isPropertyHouseBroken) {
        showPayRentModal();
      } else {
        showUpgradeModal();
      }
    }

    // ========== PAY RENT MODAL ==========
    function showPayRentModal() {
      document.getElementById('payRentModal').classList.add('active');
    }

    function closePayRentModal() {
      document.getElementById('payRentModal').classList.remove('active');
    }

    function payPropertyRent() {
      if (gameState.coins < PROPERTY_REPAIR_COST) {
        showToast('ğŸ’° Insufficient Coins!', `You need ${PROPERTY_REPAIR_COST} coins to repair.`, true);
        return;
      }

      gameState.coins -= PROPERTY_REPAIR_COST;
      gameState.isPropertyHouseBroken = false;
      gameState.propertyTimerStart = Date.now(); // Reset timer
      saveGameState();

      closePayRentModal();
      updateUI();
      updatePropertyHouseUI();

      // Show success modal
      showSuccessModal();
    }

    // ========== SUCCESS MODAL ==========
    function showSuccessModal() {
      document.getElementById('successModal').classList.add('active');
      createConfettiExplosion();
    }

    function closeSuccessModal() {
      document.getElementById('successModal').classList.remove('active');
    }

    // ========== CENTER PROPERTY MAP ==========
    function centerPropertyMap() {
      const content = document.getElementById('myPropertyContent');
      const map = content.querySelector('.property-map');
      if (content && map) {
        content.scrollLeft = (map.offsetWidth - content.offsetWidth) / 2;
        content.scrollTop = (map.offsetHeight - content.offsetHeight) / 2;
      }
    }

    function checkDailyRent() {
      const today = new Date().toDateString();

      if (gameState.lastLoginDate !== today) {
        if (gameState.lastLoginDate && !gameState.rentPaid) {
          gameState.daysSinceRent++;
          gameState.damageLevel = Math.min(gameState.damageLevel + 1, 3);

          if (gameState.daysSinceRent >= 3) {
            downgradeHome();
          }
        }

        const currentHomeData = HOMES[gameState.currentHome];
        if (currentHomeData.dailyRent > 0) {
          if (gameState.coins >= currentHomeData.dailyRent) {
            gameState.coins -= currentHomeData.dailyRent;
            gameState.rentPaid = true;
            gameState.daysSinceRent = 0;
            showRentPaidModal(currentHomeData.dailyRent);
          } else {
            gameState.rentPaid = false;
            showToast('âš ï¸ Insufficient Coins!', 'Cannot pay rent. Complete quests to earn coins!', true);
          }
        } else {
          gameState.rentPaid = true;
        }

        gameState.lastLoginDate = today;
        saveGameState();
      }
    }

    function updateUI() {
      document.getElementById('coinsDisplay').textContent = gameState.coins;
      document.getElementById('repairStars').textContent = gameState.repairStars;

      const homeData = HOMES[gameState.currentHome];
      const building = document.getElementById('homeBuilding');
      document.getElementById('homeIcon').textContent = homeData.icon;
      document.getElementById('homeLabel').innerHTML = homeData.name + '<br>' + (homeData.dailyRent > 0 ? homeData.dailyRent + ' ğŸª™/day' : 'No Rent');

      building.className = 'home-building';
      if (gameState.damageLevel > 0) {
        building.classList.add('damaged-' + gameState.damageLevel);
      }

      document.getElementById('rentDisplay').textContent = homeData.dailyRent;
      const rentBadge = document.getElementById('rentBadge');
      if (!gameState.rentPaid && homeData.dailyRent > 0) {
        rentBadge.classList.add('overdue');
      } else {
        rentBadge.classList.remove('overdue');
      }
    }

    function showHomeDetails() {
      const homeData = HOMES[gameState.currentHome];

      document.getElementById('modalHomeIcon').textContent = homeData.icon;
      document.getElementById('modalHomeTitle').textContent = homeData.name;
      document.getElementById('modalHomeSubtitle').textContent = homeData.subtitle;
      document.getElementById('modalPurchaseCost').textContent = homeData.purchaseCost === 0 ? 'Free' : homeData.purchaseCost + ' ğŸª™';
      document.getElementById('modalDailyRent').textContent = homeData.dailyRent + ' ğŸª™';

      const featuresList = document.getElementById('featuresList');
      featuresList.innerHTML = homeData.features.map(f =>
        `<div class="feature-item">${f}</div>`
      ).join('');

      const damageStatus = document.getElementById('damageStatus');
      const damageMessages = [
        { title: 'âœ… Perfect Condition', desc: 'Your home is well maintained!', class: 'healthy' },
        { title: 'âš ï¸ Minor Damage', desc: 'Cracks appearing, needs attention soon', class: '' },
        { title: 'ğŸ”§ Moderate Damage', desc: 'Furniture damaged, messy environment', class: '' },
        { title: 'ğŸš¨ Severe Damage', desc: 'Heavy damage! Repair urgently or face downgrade!', class: '' }
      ];

      const msg = damageMessages[gameState.damageLevel];
      damageStatus.className = 'damage-status ' + msg.class;
      damageStatus.innerHTML = `
                <div class="damage-title">${msg.title}</div>
                <div class="damage-description">${msg.desc}</div>
            `;

      const repairBtn = document.getElementById('repairBtn');
      repairBtn.style.display = gameState.damageLevel > 0 ? 'block' : 'none';

      const currentIndex = HOME_SEQUENCE.indexOf(gameState.currentHome);
      const upgradeBtn = document.getElementById('upgradeBtn');
      if (currentIndex < HOME_SEQUENCE.length - 1) {
        upgradeBtn.disabled = false;
        upgradeBtn.textContent = 'â¬†ï¸ Upgrade Home';
      } else {
        upgradeBtn.disabled = true;
        upgradeBtn.textContent = 'ğŸ‘‘ Max Level!';
      }

      document.getElementById('homeModal').classList.add('active');
    }

    function closeHomeModal() {
      document.getElementById('homeModal').classList.remove('active');
    }

    function showUpgradeModal() {
      currentCarouselIndex = HOME_SEQUENCE.indexOf(gameState.currentHome);
      buildCarousel();
      document.getElementById('homeModal').classList.remove('active');
      document.getElementById('upgradeModal').classList.add('active');

      // Scroll active dot into view
      setTimeout(() => {
        const activeDot = document.querySelector('.carousel-dot.active');
        if (activeDot) {
          activeDot.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
        }
      }, 100);
    }

    function closeUpgradeModal() {
      document.getElementById('upgradeModal').classList.remove('active');
    }

    function buildCarousel() {
      const navContainer = document.getElementById('carouselNav');
      const wrapperContainer = document.getElementById('carouselWrapper');

      // Build navigation dots
      navContainer.innerHTML = HOME_SEQUENCE.map((homeKey, index) => {
        const homeData = HOMES[homeKey];
        const currentIndex = HOME_SEQUENCE.indexOf(gameState.currentHome);
        let classes = 'carousel-dot';

        if (index === currentCarouselIndex) classes += ' active';
        if (index === currentIndex) classes += ' current';
        if (index > currentIndex + 1) classes += ' locked';

        return `<div class="${classes}" onclick="goToSlide(${index})" data-index="${index}">${homeData.icon}</div>`;
      }).join('');

      // Build slides
      wrapperContainer.innerHTML = HOME_SEQUENCE.map((homeKey, index) => {
        const homeData = HOMES[homeKey];
        const currentIndex = HOME_SEQUENCE.indexOf(gameState.currentHome);

        let badge = '';
        let badgeClass = '';
        if (index === currentIndex) {
          badge = 'CURRENT HOME';
          badgeClass = 'badge-current';
        } else if (index === currentIndex + 1) {
          badge = 'NEXT UPGRADE';
          badgeClass = 'badge-available';
        } else if (index > currentIndex + 1) {
          badge = 'LOCKED';
          badgeClass = 'badge-locked';
        } else {
          badge = 'PREVIOUS';
          badgeClass = 'badge-locked';
        }

        return `
                    <div class="carousel-slide">
                        <div class="home-card-header">
                            <div class="home-card-icon">${homeData.icon}</div>
                            <div class="home-card-title">${homeData.name}</div>
                            <div class="home-card-subtitle">${homeData.description}</div>
                            <div class="home-card-badge ${badgeClass}">${badge}</div>
                        </div>
                        
                        <div class="cost-grid">
                            <div class="cost-card ${index === currentIndex + 1 ? 'highlight' : ''}">
                                <div class="cost-card-label">Purchase Cost</div>
                                <div class="cost-card-value">${homeData.purchaseCost === 0 ? 'Free' : homeData.purchaseCost.toLocaleString() + ' ğŸª™'}</div>
                            </div>
                            <div class="cost-card">
                                <div class="cost-card-label">Daily Rent</div>
                                <div class="cost-card-value">${homeData.dailyRent === 0 ? 'Free' : homeData.dailyRent + ' ğŸª™'}</div>
                            </div>
                        </div>
                        
                        <div class="features-section">
                            <div class="features-header">ğŸ¡ Features & Amenities</div>
                            <div class="features-scroll">
                                <div class="features-grid">
                                    ${homeData.features.map(feature => `<div class="feature-tag">${feature}</div>`).join('')}
                                </div>
                            </div>
                        </div>
                    </div>
                `;
      }).join('');

      updateCarousel();
    }

    function goToSlide(index) {
      const currentIndex = HOME_SEQUENCE.indexOf(gameState.currentHome);

      if (index > currentIndex + 1) {
        showToast('ğŸ”’ Locked', 'Upgrade homes in sequence to unlock', true);
        return;
      }

      currentCarouselIndex = index;
      updateCarousel();

      // Scroll clicked dot into view
      const clickedDot = document.querySelector(`.carousel-dot[data-index="${index}"]`);
      if (clickedDot) {
        clickedDot.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
      }
    }

    function updateCarousel() {
      const wrapper = document.getElementById('carouselWrapper');
      wrapper.style.transform = `translateX(-${currentCarouselIndex * 100}%)`;

      document.querySelectorAll('.carousel-dot').forEach((dot, index) => {
        dot.classList.toggle('active', index === currentCarouselIndex);
      });

      const upgradeBtn = document.getElementById('carouselUpgradeBtn');
      const currentIndex = HOME_SEQUENCE.indexOf(gameState.currentHome);
      const selectedHomeKey = HOME_SEQUENCE[currentCarouselIndex];
      const selectedHomeData = HOMES[selectedHomeKey];

      if (currentCarouselIndex === currentIndex) {
        upgradeBtn.textContent = 'âœ… This is your current home';
        upgradeBtn.disabled = true;
      } else if (currentCarouselIndex === currentIndex + 1) {
        const canAfford = gameState.coins >= selectedHomeData.purchaseCost;
        upgradeBtn.textContent = `â¬†ï¸ Upgrade for ${selectedHomeData.purchaseCost.toLocaleString()} ğŸª™`;
        upgradeBtn.disabled = !canAfford;

        if (!canAfford) {
          upgradeBtn.textContent = `ğŸ’° Need ${(selectedHomeData.purchaseCost - gameState.coins).toLocaleString()} more coins`;
        }
      } else if (currentCarouselIndex < currentIndex) {
        upgradeBtn.textContent = 'â¬…ï¸ Previous home - Cannot downgrade manually';
        upgradeBtn.disabled = true;
      } else {
        upgradeBtn.textContent = 'ğŸ”’ Unlock previous homes first';
        upgradeBtn.disabled = true;
      }
    }

    function upgradeFromCarousel() {
      const currentIndex = HOME_SEQUENCE.indexOf(gameState.currentHome);

      if (currentCarouselIndex !== currentIndex + 1) return;

      const nextHomeKey = HOME_SEQUENCE[currentCarouselIndex];
      const nextHomeData = HOMES[nextHomeKey];

      if (gameState.coins >= nextHomeData.purchaseCost) {
        gameState.coins -= nextHomeData.purchaseCost;
        gameState.currentHome = nextHomeKey;
        gameState.damageLevel = 0;
        gameState.daysSinceRent = 0;

        closeUpgradeModal();
        showToast('ğŸ‰ Home Upgraded!', `Welcome to your new ${nextHomeData.name}!`);
        createConfettiExplosion();

        updateUI();
        saveGameState();
      }
    }

    function repairHome() {
      if (gameState.repairStars > 0) {
        gameState.repairStars--;
        gameState.damageLevel = 0;
        gameState.daysSinceRent = 0;

        closeHomeModal();
        showToast('ğŸ”§ Home Repaired!', 'Your home is back to perfect condition!');

        updateUI();
        saveGameState();
      }
    }

    function downgradeHome() {
      const currentIndex = HOME_SEQUENCE.indexOf(gameState.currentHome);
      if (currentIndex > 0) {
        const previousHomeKey = HOME_SEQUENCE[currentIndex - 1];
        gameState.currentHome = previousHomeKey;
        gameState.damageLevel = 0;
        gameState.daysSinceRent = 0;

        const homeData = HOMES[previousHomeKey];
        showToast('ğŸ˜” Home Downgraded', `You've moved to ${homeData.name}. Pay rent regularly to avoid this!`, true);

        updateUI();
        saveGameState();
      }
    }

    function completeQuest(questName) {
      const rewards = {
        coins: Math.floor(Math.random() * 50) + 100,
        repairStar: gameState.repairStars < 5
      };

      gameState.coins += rewards.coins;
      if (rewards.repairStar) {
        gameState.repairStars++;
      }

      updateUI();
      saveGameState();

      showToast('âœ¨ Quest Complete!', `+${rewards.coins} ğŸª™` + (rewards.repairStar ? ' +1 â­' : ''));
      createConfettiExplosion();
    }

    function showRentPaidModal(amount) {
      document.getElementById('rentPaidAmount').textContent = amount;
      document.getElementById('rentModal').classList.add('active');
      createConfettiExplosion();
    }

    function closeRentModal() {
      document.getElementById('rentModal').classList.remove('active');
    }

    function showToast(title, message, isError = false) {
      const toast = document.getElementById('toast');
      document.getElementById('toastTitle').textContent = title;
      document.getElementById('toastMessage').textContent = message;

      toast.className = 'toast' + (isError ? ' error' : '');
      toast.classList.add('active');

      // Auto-dismiss after 2 seconds
      setTimeout(() => toast.classList.remove('active'), 2000);
    }

    function createConfettiExplosion() {
      for (let i = 0; i < 40; i++) {
        setTimeout(() => createConfetti(), i * 30);
      }
    }

    function createConfetti() {
      const c = document.createElement('div');
      c.className = 'confetti';
      c.style.left = Math.random() * 100 + '%';
      c.style.backgroundColor = ['#FF6B35', '#FFD700', '#4CAF50', '#2196F3', '#9C27B0'][Math.floor(Math.random() * 5)];
      c.style.animationDelay = Math.random() * 0.3 + 's';
      document.body.appendChild(c);
      setTimeout(() => c.remove(), 3000);
    }

    function centerMap() {
      const content = document.querySelector('.content');
      const map = document.querySelector('.city-map');
      content.scrollLeft = (map.offsetWidth - content.offsetWidth) / 2;
      content.scrollTop = (map.offsetHeight - content.offsetHeight) / 2;
    }

    // Start the game
    window.addEventListener('load', init);
  </script>
  <script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-analytics.js";
    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries

    // Your web app's Firebase configuration
    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
    const firebaseConfig = {
      apiKey: "AIzaSyAiGiHF9BUDD7JY5uU7jO1dtcqKR9GJggc",
      authDomain: "clbl-games.firebaseapp.com",
      projectId: "clbl-games",
      storageBucket: "clbl-games.firebasestorage.app",
      messagingSenderId: "1072410751082",
      appId: "1:1072410751082:web:7c46182049e7ae3b6f5a13",
      measurementId: "G-GJBR2YGL1Y"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
  </script>
</body>

</html>