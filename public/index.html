<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SpeakX CLBL - Interactive Demo with Special Features</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #FF6B35 0%, #F7931E 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .phone-frame {
      width: 390px;
      height: 844px;
      background: #000;
      border-radius: 40px;
      padding: 12px;
      box-shadow: 0 25px 80px rgba(0, 0, 0, 0.4);
    }

    .screen {
      width: 100%;
      height: 100%;
      background: #f5f5f5;
      border-radius: 30px;
      overflow: hidden;
      position: relative;
    }

    /* Status Bar & Header */
    .status-bar {
      height: 44px;
      background: linear-gradient(135deg, #FF6B35 0%, #F7931E 100%);
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 20px;
      color: white;
      font-size: 14px;
      font-weight: 500;
      z-index: 200;
    }

    .header {
      background: white;
      padding: 12px 15px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
      z-index: 200;
    }

    .user-info {
      display: flex;
      align-items: center;
      gap: 10px;
      flex: 1;
    }

    .avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: linear-gradient(135deg, #FF6B35 0%, #F7931E 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 22px;
    }

    .user-details {
      flex: 1;
    }

    .user-name {
      font-size: 15px;
      font-weight: bold;
      color: #333;
    }

    .user-location {
      font-size: 11px;
      color: #666;
    }

    .header-actions {
      display: flex;
      gap: 6px;
      align-items: center;
      flex-wrap: wrap;
    }

    /* Header Badges */
    .challenges-icon-wrapper {
      position: relative;
      cursor: pointer;
    }

    .challenges-icon {
      width: 38px;
      height: 38px;
      background: linear-gradient(135deg, #4CAF50 0%, #8BC34A 100%);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      box-shadow: 0 3px 10px rgba(76, 175, 80, 0.3);
      transition: transform 0.2s;
    }

    .challenges-icon:active {
      transform: scale(0.95);
    }

    .challenges-badge {
      position: absolute;
      top: -4px;
      right: -4px;
      background: #f44336;
      color: white;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 10px;
      font-weight: bold;
      border: 2px solid white;
    }

    .journey-points-badge {
      background: linear-gradient(135deg, #9C27B0 0%, #E91E63 100%);
      padding: 6px 12px;
      border-radius: 20px;
      display: flex;
      align-items: center;
      gap: 5px;
      font-weight: bold;
      color: white;
      font-size: 13px;
      box-shadow: 0 3px 10px rgba(156, 39, 176, 0.3);
    }

    .leaderboard-icon {
      width: 38px;
      height: 38px;
      background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      cursor: pointer;
      box-shadow: 0 3px 10px rgba(255, 165, 0, 0.3);
      transition: transform 0.2s;
    }

    .leaderboard-icon:active {
      transform: scale(0.95);
    }

    .coins-badge {
      background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
      padding: 6px 14px;
      border-radius: 20px;
      display: flex;
      align-items: center;
      gap: 5px;
      font-weight: bold;
      color: white;
      font-size: 13px;
      box-shadow: 0 3px 10px rgba(255, 165, 0, 0.3);
    }

    /* Map - Made scrollable in all directions */
    .content {
      position: absolute;
      top: 104px;
      left: 0;
      right: 0;
      bottom: 0;
      overflow: scroll;
    }

    .content::-webkit-scrollbar {
      width: 0;
      height: 0;
    }

    .city-map {
      width: 200%;
      height: 200%;
      background: #E8F5E9;
      position: relative;
      padding: 20px;
    }

    .map-background {
      position: absolute;
      inset: 0;
      background:
        repeating-linear-gradient(0deg, rgba(76, 175, 80, 0.03) 0, rgba(76, 175, 80, 0.03) 1px, transparent 1px, transparent 50px),
        repeating-linear-gradient(90deg, rgba(76, 175, 80, 0.03) 0, rgba(76, 175, 80, 0.03) 1px, transparent 1px, transparent 50px),
        linear-gradient(135deg, #E8F5E9 0%, #C8E6C9 100%);
    }

    .map-road {
      position: absolute;
      background: rgba(255, 255, 255, 0.6);
      border: 2px dashed rgba(255, 152, 0, 0.3);
      z-index: 1;
    }

    .road-horizontal {
      height: 30px;
      width: 100%;
      top: 50%;
      left: 0;
    }

    .road-vertical {
      width: 30px;
      height: 100%;
      top: 0;
      left: 50%;
    }

    .map-landmark {
      position: absolute;
      z-index: 1;
      opacity: 0.15;
      pointer-events: none;
      font-size: 70px;
    }

    .map-tree {
      position: absolute;
      font-size: 35px;
      opacity: 0.2;
      z-index: 1;
      pointer-events: none;
    }

    .map-explored {
      position: fixed;
      top: 120px;
      left: 25px;
      background: white;
      padding: 8px 12px;
      border-radius: 18px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      z-index: 100;
      border: 2px solid #FF6B35;
    }

    .explored-text {
      font-size: 11px;
      color: #666;
      margin-bottom: 3px;
    }

    .explored-value {
      font-size: 22px;
      font-weight: bold;
      color: #FF6B35;
    }

    /* Home building - centered in map */
    .home-building {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 70px;
      height: 70px;
      background: white;
      border-radius: 13px;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 10;
      border: 3px solid #FF6B35;
    }

    .home-icon {
      font-size: 32px;
      margin-bottom: 4px;
    }

    .home-label {
      font-size: 10px;
      font-weight: bold;
      color: #FF6B35;
    }

    /* Quest Pins - Made smaller */
    .quest-pin {
      position: absolute;
      width: 50px;
      height: 50px;
      cursor: pointer;
      transition: transform 0.3s;
      z-index: 5;
    }

    .quest-pin:hover {
      transform: scale(1.15);
    }

    .pin-icon {
      width: 50px;
      height: 50px;
      background: linear-gradient(135deg, #FF6B35, #F7931E);
      border-radius: 50% 50% 50% 0;
      transform: rotate(-45deg);
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 15px rgba(255, 107, 53, 0.4);
    }

    .pin-emoji {
      font-size: 22px;
      transform: rotate(45deg);
    }

    .pin-label {
      position: absolute;
      bottom: -24px;
      left: 50%;
      transform: translateX(-50%);
      background: white;
      padding: 3px 8px;
      border-radius: 10px;
      font-size: 10px;
      font-weight: bold;
      white-space: nowrap;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      border: 1.5px solid #FF6B35;
    }

    .tomorrow-pill {
      position: fixed;
      top: 210px;
      right: 25px;
      background: white;
      border-radius: 13px;
      padding: 10px 13px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
      z-index: 100;
      border: 2px solid #ddd;
      display: flex;
      align-items: center;
      gap: 10px;
      cursor: pointer;
      transition: transform 0.2s;
    }

    .tomorrow-pill:active {
      transform: scale(0.95);
    }

    .tomorrow-pill.unlocked {
      border-color: #4CAF50;
    }

    .ticket-icon {
      font-size: 30px;
    }

    .ticket-text {
      flex: 1;
    }

    .ticket-title {
      font-size: 12px;
      font-weight: bold;
      color: #333;
    }

    .ticket-subtitle {
      font-size: 9px;
      color: #999;
      margin-top: 2px;
    }

    /* Special Quest Modal */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.7);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 300;
    }

    .modal-overlay.active {
      display: flex;
    }

    .modal-content {
      background: white;
      border-radius: 25px;
      padding: 30px;
      width: 90%;
      max-width: 340px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    }

    .modal-header {
      font-size: 22px;
      font-weight: bold;
      color: #FF6B35;
      margin-bottom: 20px;
      text-align: center;
    }

    .special-word-card {
      background: linear-gradient(135deg, #FFF4E6 0%, #FFE9CC 100%);
      padding: 25px;
      border-radius: 18px;
      text-align: center;
      margin-bottom: 25px;
    }

    .special-word {
      font-size: 32px;
      font-weight: bold;
      color: #FF6B35;
      margin-bottom: 12px;
    }

    .special-meaning {
      font-size: 16px;
      color: #333;
      margin-bottom: 8px;
    }

    .special-hindi {
      font-size: 20px;
      color: #666;
    }

    .special-options {
      display: flex;
      flex-direction: column;
      gap: 12px;
      margin-top: 20px;
    }

    .special-option {
      background: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%);
      border: none;
      padding: 16px;
      border-radius: 13px;
      font-size: 18px;
      font-weight: bold;
      color: #1976D2;
      cursor: pointer;
      transition: transform 0.2s;
    }

    .special-option:active {
      transform: scale(0.97);
    }

    .modal-button {
      width: 100%;
      background: linear-gradient(135deg, #FF6B35 0%, #F7931E 100%);
      border: none;
      padding: 16px;
      border-radius: 13px;
      font-size: 17px;
      font-weight: bold;
      color: white;
      cursor: pointer;
      box-shadow: 0 5px 18px rgba(255, 107, 53, 0.3);
      transition: transform 0.2s;
    }

    .modal-button:active {
      transform: scale(0.97);
    }

    /* Tomorrow Reward Modal */
    .reward-modal-content {
      background: linear-gradient(135deg, #FFF4E6 0%, #FFE9CC 100%);
      border-radius: 25px;
      padding: 35px;
      text-align: center;
      width: 90%;
      max-width: 340px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    }

    .reward-title {
      font-size: 26px;
      font-weight: bold;
      color: #FF6B35;
      margin-bottom: 15px;
    }

    .reward-subtitle {
      font-size: 14px;
      color: #666;
      margin-bottom: 25px;
    }

    .reward-items {
      background: white;
      border-radius: 18px;
      padding: 25px;
      margin-bottom: 20px;
    }

    .reward-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 0;
      border-bottom: 1px solid #f0f0f0;
    }

    .reward-item:last-child {
      border-bottom: none;
    }

    .reward-label {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 15px;
      font-weight: 600;
    }

    .reward-value {
      font-size: 19px;
      font-weight: bold;
      color: #FF6B35;
    }

    .close-button {
      background: linear-gradient(135deg, #4CAF50 0%, #8BC34A 100%);
      border: none;
      padding: 14px;
      border-radius: 13px;
      font-size: 16px;
      font-weight: bold;
      color: white;
      cursor: pointer;
      width: 100%;
    }

    /* Challenges Sheet */
    .challenges-sheet {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: white;
      border-radius: 25px 25px 0 0;
      max-height: 75vh;
      transform: translateY(100%);
      transition: transform 0.3s ease-out;
      z-index: 400;
      box-shadow: 0 -10px 40px rgba(0, 0, 0, 0.2);
    }

    .challenges-sheet.active {
      transform: translateY(0);
    }

    .sheet-header {
      padding: 20px;
      border-bottom: 1px solid #f0f0f0;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .sheet-title {
      font-size: 20px;
      font-weight: bold;
      color: #333;
    }

    .close-sheet {
      font-size: 28px;
      cursor: pointer;
      color: #999;
    }

    .sheet-tabs {
      display: flex;
      padding: 15px;
      gap: 10px;
      border-bottom: 1px solid #f0f0f0;
    }

    .tab {
      flex: 1;
      padding: 10px;
      background: #f5f5f5;
      border: none;
      border-radius: 10px;
      font-size: 13px;
      font-weight: 600;
      color: #666;
      cursor: pointer;
    }

    .tab.active {
      background: linear-gradient(135deg, #FF6B35 0%, #F7931E 100%);
      color: white;
    }

    .sheet-content {
      padding: 15px;
      max-height: 50vh;
      overflow-y: auto;
    }

    .tab-panel {
      display: none;
    }

    .tab-panel.active {
      display: block;
    }

    .challenge-card {
      background: linear-gradient(135deg, #E3F2FD 0%, #BBDEFB 100%);
      border-radius: 15px;
      padding: 18px;
      margin-bottom: 12px;
    }

    .challenge-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }

    .challenge-text {
      font-size: 15px;
      font-weight: bold;
      color: #1976D2;
    }

    .challenge-quest {
      font-size: 13px;
      color: #333;
      margin-bottom: 6px;
    }

    .challenge-time {
      font-size: 12px;
      color: #666;
      margin-bottom: 15px;
    }

    .challenge-actions {
      display: flex;
      gap: 10px;
    }

    .accept-btn,
    .decline-btn {
      flex: 1;
      padding: 10px;
      border: none;
      border-radius: 10px;
      font-size: 14px;
      font-weight: bold;
      cursor: pointer;
    }

    .accept-btn {
      background: linear-gradient(135deg, #4CAF50 0%, #8BC34A 100%);
      color: white;
    }

    .decline-btn {
      background: #f5f5f5;
      color: #999;
    }

    .empty-state {
      text-align: center;
      padding: 40px;
      color: #999;
      font-size: 14px;
    }

    /* Toast Notification */
    .toast {
      position: fixed;
      top: 120px;
      left: 50%;
      transform: translateX(-50%) translateY(-150%);
      background: white;
      padding: 18px 25px;
      border-radius: 18px;
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
      z-index: 500;
      transition: transform 0.4s ease-out;
      border: 2px solid #4CAF50;
    }

    .toast.active {
      transform: translateX(-50%) translateY(0);
    }

    .toast-title {
      font-size: 17px;
      font-weight: bold;
      color: #4CAF50;
      text-align: center;
      margin-bottom: 8px;
    }

    .toast-rewards {
      font-size: 19px;
      font-weight: bold;
      color: #FF6B35;
      text-align: center;
    }

    /* Confetti Animation */
    .confetti {
      position: fixed;
      width: 10px;
      height: 10px;
      border-radius: 50%;
      animation: fall 3s linear;
      z-index: 600;
    }

    @keyframes fall {
      to {
        transform: translateY(100vh) rotate(720deg);
        opacity: 0;
      }
    }
  </style>
</head>

<body>
  <div class="phone-frame">
    <div class="screen">
      <!-- Status Bar -->
      <div class="status-bar">
        <div>9:41</div>
        <div>üì∂ ‚ö° 100%</div>
      </div>

      <!-- Header -->
      <div class="header">
        <div class="user-info">
          <div class="avatar">üë®</div>
          <div class="user-details">
            <div class="user-name">Rahul Sharma</div>
            <div class="user-location">üìç Connaught Place</div>
          </div>
        </div>
        <div class="header-actions">
          <div class="challenges-icon-wrapper" onclick="showChallengesSheet()">
            <div class="challenges-icon">‚öîÔ∏è</div>
            <div class="challenges-badge" id="challengesBadge">2</div>
          </div>
          <div class="journey-points-badge">
            <span id="journeyPoints">0</span> ‚≠ê
          </div>
          <div class="leaderboard-icon">üèÜ</div>
          <div class="coins-badge">
            <span id="coinsDisplay">150</span> ü™ô
          </div>
        </div>
      </div>

      <!-- Map Content - Now scrollable in all directions -->
      <div class="content">
        <div class="city-map">
          <div class="map-background"></div>

          <!-- Roads -->
          <div class="map-road road-horizontal"></div>
          <div class="map-road road-vertical"></div>

          <!-- Decorative Elements -->
          <div class="map-landmark" style="top: 15%; left: 15%;">üèõÔ∏è</div>
          <div class="map-landmark" style="bottom: 20%; right: 20%;">üïå</div>
          <div class="map-tree" style="top: 25%; left: 35%;">üå≥</div>
          <div class="map-tree" style="top: 60%; left: 70%;">üå≥</div>
          <div class="map-tree" style="bottom: 30%; left: 25%;">üå≥</div>
          <div class="map-tree" style="top: 40%; right: 30%;">üå≥</div>

          <!-- Home Building - Centered -->
          <div class="home-building">
            <div class="home-icon">üè†</div>
            <div class="home-label">HOME</div>
          </div>

          <!-- Quest Pins - Smaller and distributed around center -->
          <div class="quest-pin" style="top: 35%; left: 60%;" onclick="startQuest('üçΩÔ∏è Restaurant')">
            <div class="pin-icon">
              <div class="pin-emoji">üçΩÔ∏è</div>
            </div>
            <div class="pin-label">Restaurant</div>
          </div>

          <div class="quest-pin" style="top: 60%; left: 35%;" onclick="startQuest('üè¶ Bank')">
            <div class="pin-icon">
              <div class="pin-emoji">üè¶</div>
            </div>
            <div class="pin-label">Bank</div>
          </div>

          <div class="quest-pin" style="top: 30%; left: 35%;" onclick="startQuest('üå≥ Park')">
            <div class="pin-icon">
              <div class="pin-emoji">üå≥</div>
            </div>
            <div class="pin-label">Park</div>
          </div>

          <div class="quest-pin" style="top: 55%; left: 60%;" onclick="startQuest('üè• Hospital')">
            <div class="pin-icon">
              <div class="pin-emoji">üè•</div>
            </div>
            <div class="pin-label">Hospital</div>
          </div>

          <div class="quest-pin" style="top: 42%; left: 70%;" onclick="startQuest('üè™ Store')">
            <div class="pin-icon">
              <div class="pin-emoji">üè™</div>
            </div>
            <div class="pin-label">Store</div>
          </div>

          <div class="quest-pin" style="top: 68%; left: 48%;" onclick="startQuest('üöâ Station')">
            <div class="pin-icon">
              <div class="pin-emoji">üöâ</div>
            </div>
            <div class="pin-label">Station</div>
          </div>
        </div>
      </div>

      <!-- Map Explored Counter -->
      <div class="map-explored">
        <div class="explored-text">MAP EXPLORED</div>
        <div class="explored-value"><span id="mapExplored">25</span>%</div>
      </div>

      <!-- Tomorrow Ticket -->
      <div class="tomorrow-pill" id="tomorrowPill" onclick="showTomorrowReward()">
        <div class="ticket-icon">üé´</div>
        <div class="ticket-text">
          <div class="ticket-title">Tomorrow Ticket</div>
          <div class="ticket-subtitle">Complete 1 quest</div>
        </div>
      </div>

      <!-- Special Quest Modal -->
      <div class="modal-overlay" id="specialQuestModal">
        <div class="modal-content">
          <div class="modal-header">‚ú® Special Quest! ‚ú®</div>
          <div id="specialQuestContent"></div>
        </div>
      </div>

      <!-- Tomorrow Reward Modal -->
      <div class="modal-overlay" id="tomorrowRewardModal">
        <div class="reward-modal-content">
          <div class="reward-title">üéÅ Tomorrow's Rewards!</div>
          <div class="reward-subtitle">Complete quests tomorrow to get:</div>
          <div class="reward-items">
            <div class="reward-item">
              <div class="reward-label">ü™ô Coins</div>
              <div class="reward-value">2x</div>
            </div>
            <div class="reward-item">
              <div class="reward-label">‚≠ê Journey Points</div>
              <div class="reward-value">2x</div>
            </div>
            <div class="reward-item">
              <div class="reward-label">üéØ Special Quests</div>
              <div class="reward-value">+50%</div>
            </div>
          </div>
          <button class="close-button" onclick="closeTomorrowReward()">Got it! ‚úì</button>
        </div>
      </div>

      <!-- Challenges Sheet -->
      <div class="challenges-sheet" id="challengesSheet">
        <div class="sheet-header">
          <div class="sheet-title">‚öîÔ∏è Challenges</div>
          <div class="close-sheet" onclick="closeChallengesSheet()">√ó</div>
        </div>
        <div class="sheet-tabs">
          <button class="tab active" onclick="switchTab(0)">New (2)</button>
          <button class="tab" onclick="switchTab(1)">Pending (1)</button>
          <button class="tab" onclick="switchTab(2)">Completed</button>
        </div>
        <div class="sheet-content">
          <div class="tab-panel active" id="panel0">
            <div class="challenge-card">
              <div class="challenge-header">
                <span class="challenge-text">Priya challenged you!</span>
              </div>
              <div class="challenge-quest">üçΩÔ∏è Restaurant ‚Ä¢ Word Battle</div>
              <div class="challenge-time">‚è±Ô∏è 23h 45m left</div>
              <div class="challenge-actions">
                <button class="accept-btn" onclick="acceptChallenge('Priya', 'üçΩÔ∏è Restaurant')">Accept</button>
                <button class="decline-btn" onclick="declineChallenge()">Decline</button>
              </div>
            </div>
            <div class="challenge-card">
              <div class="challenge-header">
                <span class="challenge-text">Amit challenged you!</span>
              </div>
              <div class="challenge-quest">üè¶ Bank ‚Ä¢ Grammar Duel</div>
              <div class="challenge-time">‚è±Ô∏è 22h 30m left</div>
              <div class="challenge-actions">
                <button class="accept-btn" onclick="acceptChallenge('Amit', 'üè¶ Bank')">Accept</button>
                <button class="decline-btn" onclick="declineChallenge()">Decline</button>
              </div>
            </div>
          </div>
          <div class="tab-panel" id="panel1">
            <div class="challenge-card">
              <div class="challenge-header">
                <span class="challenge-text">Waiting for Rahul</span>
              </div>
              <div class="challenge-quest">üå≥ Park ‚Ä¢ Speed Race</div>
              <div class="challenge-time">‚è±Ô∏è 20h 15m left</div>
              <div style="font-size: 12px; color: #999; margin-top: 7px;">Pending...</div>
            </div>
          </div>
          <div class="tab-panel" id="panel2">
            <div class="empty-state">No completed challenges yet</div>
          </div>
        </div>
      </div>

      <!-- Toast Notification -->
      <div class="toast" id="toast">
        <div class="toast-title">‚ú® Nice! ‚ú®</div>
        <div class="toast-rewards">+<span id="toastCoins">5</span> ü™ô ‚Ä¢ +<span id="toastPoints">2</span> ‚≠ê</div>
      </div>
    </div>
  </div>

  <script>
    let gameState = {
      coins: 150,
      journeyPoints: 0,
      mapExplored: 25,
      tomorrowTicketClaimed: false,
      specialQuestShown: false
    };

    function updateCoins(amt) {
      gameState.coins += amt;
      document.getElementById('coinsDisplay').textContent = gameState.coins;
    }
    function updateJourneyPoints(amt) {
      gameState.journeyPoints += amt;
      document.getElementById('journeyPoints').textContent = gameState.journeyPoints;
    }
    function updateMapExplored(amt) {
      gameState.mapExplored = Math.min(gameState.mapExplored + amt, 100);
      document.getElementById('mapExplored').textContent = gameState.mapExplored;
    }

    function startQuest(name) {
      // 40% chance to show special quest
      if (!gameState.specialQuestShown && Math.random() < 0.4) {
        setTimeout(() => showSpecialQuest(), 1500);
        gameState.specialQuestShown = true;
      }
      alert(`üö∂ Starting: ${name}\n\nWatch for surprise quests on the way!`);
    }

    function showSpecialQuest() {
      const types = ['vocab', 'grammar', 'speaking'];
      const type = types[Math.floor(Math.random() * types.length)];
      const modal = document.getElementById('specialQuestModal');
      const content = document.getElementById('specialQuestContent');

      if (type === 'vocab') {
        content.innerHTML = `
                    <div class="special-word-card">
                        <div class="special-word">Fare</div>
                        <div class="special-meaning">Money to pay for ride</div>
                        <div class="special-hindi">‡§ï‡§ø‡§∞‡§æ‡§Ø‡§æ</div>
                    </div>
                    <button class="modal-button" onclick="completeSpecialQuest(5, 2)">Got it! ‚úì</button>
                `;
      } else if (type === 'grammar') {
        content.innerHTML = `
                    <div style="font-size: 17px; font-weight: bold; margin-bottom: 18px;">How much _____ it?</div>
                    <div class="special-options">
                        <button class="special-option" onclick="completeSpecialQuest(8, 3)">is</button>
                        <button class="special-option" onclick="completeSpecialQuest(8, 3)">are</button>
                    </div>
                `;
      } else {
        content.innerHTML = `
                    <div style="font-size: 23px; font-weight: bold; color: #FF6B35; margin-bottom: 18px; padding: 18px; background: #FFF4E6; border-radius: 13px;">"India Gate, please"</div>
                    <button class="modal-button" onclick="simulateRecording()" style="background: linear-gradient(135deg, #4CAF50, #8BC34A);">üé§ Tap to Speak</button>
                `;
      }
      modal.classList.add('active');
    }

    function simulateRecording() {
      const btn = event.target;
      btn.innerHTML = 'üé§ Recording...';
      btn.disabled = true;
      setTimeout(() => {
        btn.innerHTML = '‚úì Great!';
        setTimeout(() => completeSpecialQuest(10, 5), 500);
      }, 2000);
    }

    function completeSpecialQuest(coins, points) {
      document.getElementById('specialQuestModal').classList.remove('active');
      updateCoins(coins);
      updateJourneyPoints(points);

      document.getElementById('toastCoins').textContent = coins;
      document.getElementById('toastPoints').textContent = points;
      const toast = document.getElementById('toast');
      toast.classList.add('active');

      for (let i = 0; i < 30; i++) createConfetti();

      setTimeout(() => toast.classList.remove('active'), 1500);

      if (!gameState.tomorrowTicketClaimed) claimTomorrowTicket();
    }

    function claimTomorrowTicket() {
      gameState.tomorrowTicketClaimed = true;
      const pill = document.getElementById('tomorrowPill');
      pill.classList.add('unlocked');
      pill.innerHTML = `
                <div class="ticket-icon">‚úÖ</div>
                <div class="ticket-text">
                    <div class="ticket-title">Tomorrow: 2x Coins!</div>
                    <div class="ticket-subtitle">Tap to preview</div>
                </div>
            `;
      setTimeout(() => alert('üéâ Tomorrow Reward Unlocked!\n\nTap the badge to see what you\'ll get!'), 500);
    }

    function showTomorrowReward() {
      if (gameState.tomorrowTicketClaimed) {
        document.getElementById('tomorrowRewardModal').classList.add('active');
        for (let i = 0; i < 50; i++) createConfetti();
      } else {
        alert('üîí Complete 1 quest or 2 special quests to unlock!');
      }
    }

    function closeTomorrowReward() {
      document.getElementById('tomorrowRewardModal').classList.remove('active');
    }

    function showChallengesSheet() {
      document.getElementById('challengesSheet').classList.add('active');
    }

    function closeChallengesSheet() {
      document.getElementById('challengesSheet').classList.remove('active');
    }

    function switchTab(idx) {
      document.querySelectorAll('.tab').forEach((tab, i) => {
        tab.classList.toggle('active', i === idx);
        document.getElementById('panel' + i).classList.toggle('active', i === idx);
      });
    }

    function acceptChallenge(name, quest) {
      alert(`‚úÖ Challenge Accepted!\n\nRace ${name} to complete ${quest}\nGood luck! üéØ`);
      closeChallengesSheet();
      const badge = document.getElementById('challengesBadge');
      const count = parseInt(badge.textContent) - 1;
      badge.textContent = count;
      if (count === 0) badge.style.display = 'none';
    }

    function declineChallenge() {
      alert('Challenge declined');
      closeChallengesSheet();
      const badge = document.getElementById('challengesBadge');
      const count = parseInt(badge.textContent) - 1;
      badge.textContent = count;
      if (count === 0) badge.style.display = 'none';
    }

    function createConfetti() {
      const c = document.createElement('div');
      c.className = 'confetti';
      c.style.left = Math.random() * 100 + '%';
      c.style.backgroundColor = ['#FF6B35', '#FFD700', '#4CAF50', '#2196F3'][Math.floor(Math.random() * 4)];
      c.style.animationDelay = Math.random() * 0.5 + 's';
      document.body.appendChild(c);
      setTimeout(() => c.remove(), 3000);
    }

    // Center the map on home on load
    window.addEventListener('load', () => {
      const content = document.querySelector('.content');
      const map = document.querySelector('.city-map');
      // Scroll to center the home building
      content.scrollLeft = (map.offsetWidth - content.offsetWidth) / 2;
      content.scrollTop = (map.offsetHeight - content.offsetHeight) / 2;
    });

    // Auto demo after 2 seconds
    setTimeout(() => {
      if (confirm('üéÆ DEMO MODE\n\nWant to see a Special Quest appear during commute?\n\nClick OK to trigger!')) {
        showSpecialQuest();
      }
    }, 2000);
  </script>
  <script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-analytics.js";
    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries

    // Your web app's Firebase configuration
    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
    const firebaseConfig = {
      apiKey: "AIzaSyAiGiHF9BUDD7JY5uU7jO1dtcqKR9GJggc",
      authDomain: "clbl-games.firebaseapp.com",
      projectId: "clbl-games",
      storageBucket: "clbl-games.firebasestorage.app",
      messagingSenderId: "1072410751082",
      appId: "1:1072410751082:web:7c46182049e7ae3b6f5a13",
      measurementId: "G-GJBR2YGL1Y"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
  </script>
</body>

</html>
